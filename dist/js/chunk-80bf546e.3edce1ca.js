(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-80bf546e"],{"0d47":function(t,e,n){},"18a5":function(t,e,n){"use strict";var a=n("23e7"),r=n("857a"),o=n("af03");a({target:"String",proto:!0,forced:o("anchor")},{anchor:function(t){return r(this,"a","name",t)}})},"2c43":function(t,e,n){},"407a":function(t,e,n){"use strict";n("530f")},4783:function(t,e,n){},"47d0":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Layout",{scopedSlots:t._u([{key:"right",fn:function(){return[n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"right-container"},[t.article?n("BlogDetailTOC",{attrs:{tocInfo:t.article.toc}}):t._e()],1)]},proxy:!0}])},[[n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],ref:"blogContentDiv",staticClass:"blogInfo-container"},[t.article?n("BlogDetailInfo",{attrs:{article:t.article}}):t._e(),t.isLoading?t._e():n("CommentMessage",{attrs:{title:"评论",subTitle:"("+t.comment.total+")",commentList:t.comment.rows,isLoading:t.isCommentLoading},on:{submit:t.handleSubmit}})],1)]],2)},r=[],o=n("5530"),i=n("2909"),s=n("1da1"),c=(n("99af"),n("96cf"),n("5849")),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"blog-detail-info-container"},[n("h1",[t._v(t._s(t.article.title))]),n("div",{staticClass:"other-info"},[n("span",[t._v("日期: "+t._s(t._f("formatDate")(t.article.createDate)))]),n("span",[t._v("浏览: "+t._s(t.article.scanNumber))]),n("a",{attrs:{href:"#comment-content"}},[n("span",[t._v("评论: "+t._s(t.article.commentNumber))])]),n("router-link",{attrs:{to:{name:"type",params:{id:t.article.category.id}}}},[n("span",[t._v(t._s(t.article.category.name))])])],1),n("div",{staticClass:"main-container markdown-body",domProps:{innerHTML:t._s(t.article.htmlContent)}})])},u=[],m=(n("db6a"),n("2c43"),{props:{article:{type:Object,required:!0}}}),d=m,f=(n("407a"),n("2877")),h=Object(f["a"])(d,l,u,!1,null,"2d458056",null),v=h.exports,p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"blog-detail-toc-container"},[n("h1",[t._v("目录")]),n("TreeMenu",{attrs:{list:t.newToc},on:{select:t.handleSelect}})],1)},g=[],b=(n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),n("06c5"));function C(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=Object(b["a"])(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return i=t.done,t},e:function(t){s=!0,o=t},f:function(){try{i||null==n["return"]||n["return"]()}finally{if(s)throw o}}}}n("d81d"),n("18a5");var _=n("8602"),w=n("ed08"),y={components:{TreeMenu:_["a"]},props:{tocInfo:{type:Array,required:!0}},data:function(){return{domId:""}},computed:{newToc:function(){var t=this,e=function e(n){return n.map((function(n){return Object(o["a"])(Object(o["a"])({},n),{},{isSelect:t.domId===n.anchor,children:e(n.children?n.children:[])})}))};return e(this.tocInfo)},getDoms:function(){var t=[],e=function e(n){var a,r=C(n);try{for(r.s();!(a=r.n()).done;){var o=a.value;t.push(document.getElementById(o.anchor)),o.children&&o.children.length>0&&e(o.children)}}catch(i){r.e(i)}finally{r.f()}};return e(this.tocInfo),t}},methods:{handleSelect:function(t){location.hash=t.anchor},setIsSelect:function(t){if(t){this.domId="";var e,n=C(this.getDoms);try{for(n.s();!(e=n.n()).done;){var a=e.value,r=a.getBoundingClientRect().top;if(!(r<=0))return r>0&&r<=150?void(this.domId=a.id):void 0;this.domId=a.id}}catch(o){n.e(o)}finally{n.f()}}}},created:function(){this.$bus.$on("mainscroll",Object(w["a"])(this.setIsSelect,100))}},k=y,D=(n("481f"),Object(f["a"])(k,p,g,!1,null,"73cc3cf9",null)),x=D.exports,$=n("e836"),L=n("4ec2"),S={components:{Layout:c["a"],BlogDetailInfo:v,BlogDetailTOC:x,CommentMessage:L["a"]},data:function(){return{article:null,comment:{},isLoading:!0,isCommentLoading:!0,page:1,limit:10}},created:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object($["b"])(t.$route.params.id);case 2:if(n=e.sent,n){e.next=6;break}return t.$router.push("/404"),e.abrupt("return");case 6:return t.article=n,t.isLoading=!1,e.next=10,Object($["e"])(t.$route.params.id,t.page,t.limit);case 10:a=e.sent,t.comment=a,t.isCommentLoading=!1;case 13:case"end":return e.stop()}}),e)})))()},computed:{hasMoreComment:function(){return this.comment.total>=this.comment.rows.length}},methods:{getMoreComment:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.hasMoreComment){e.next=2;break}return e.abrupt("return");case 2:return t.isCommentLoading=!0,t.page++,e.next=6,Object($["e"])(t.$route.params.id,t.page,t.limit);case 6:n=e.sent,t.comment.total=n.total,t.comment.rows=[].concat(Object(i["a"])(t.comment.rows),Object(i["a"])(n.rows)),t.isCommentLoading=!1;case 10:case"end":return e.stop()}}),e)})))()},handleSubmit:function(t,e){var n=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object($["a"])(Object(o["a"])({blogId:n.$route.params.id},t));case 2:r=a.sent,n.comment.rows.unshift(r),n.comment.total++,e("评论成功");case 6:case"end":return a.stop()}}),a)})))()},handleScroll:function(){if(this.$bus.$emit("mainscroll",this.$refs.blogContentDiv),!this.isCommentLoading){var t=this.$refs.blogContentDiv,e=t.clientHeight,n=t.scrollTop,a=t.scrollHeight;a-(e+n)<100&&this.getMoreComment()}}},mounted:function(){var t=this;this.$bus.$on("totopclick",(function(e){t.$refs.blogContentDiv.scrollTop=e})),this.$refs.blogContentDiv.addEventListener("scroll",this.handleScroll)},beforeDestroy:function(){this.$bus.$off("totopclick"),this.$bus.$emit("mainscroll"),this.$refs.blogContentDiv.removeEventListener("scroll",this.handleScroll)},updated:function(){var t=location.hash;location.hash="",setTimeout((function(){location.hash=t}))}},I=S,O=(n("a5ff"),Object(f["a"])(I,a,r,!1,null,"d1dfb888",null));e["default"]=O.exports},"481f":function(t,e,n){"use strict";n("e3cd")},"4ec2":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"message-comment-container"},[n("h1",{attrs:{id:"comment-content"}},[t._v(t._s(t.title)+"区")]),n("form",{ref:"form",staticClass:"form-data",on:{submit:function(e){return e.preventDefault(),t.handleSubmit(e)}}},[n("div",{staticClass:"form-item"},[n("div",{staticClass:"input"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.nickname,expression:"formData.nickname"}],attrs:{type:"text",placeholder:"用户昵称",maxlength:"10"},domProps:{value:t.formData.nickname},on:{focus:t.handkeFocus,input:function(e){e.target.composing||t.$set(t.formData,"nickname",e.target.value)}}}),n("span",{staticClass:"tip"},[t._v(t._s(t.formData.nickname.length)+"/10")])]),n("div",{staticClass:"err"},[n("Icon",{directives:[{name:"show",rawName:"v-show",value:t.error.nickname,expression:"error.nickname"}],attrs:{type:"error"}}),n("span",[t._v(t._s(t.error.nickname))])],1)]),n("div",{staticClass:"form-item"},[n("div",{staticClass:"textarea"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formData.content,expression:"formData.content"}],attrs:{placeholder:"输入信息",maxlength:"300"},domProps:{value:t.formData.content},on:{input:function(e){e.target.composing||t.$set(t.formData,"content",e.target.value)}}}),n("span",{staticClass:"tip"},[t._v(t._s(t.formData.content.length)+"/300")])]),n("div",{staticClass:"err"},[n("Icon",{directives:[{name:"show",rawName:"v-show",value:t.error.content,expression:"error.content"}],attrs:{type:"error"}}),n("span",[t._v(t._s(t.error.content))])],1)]),n("div",{staticClass:"form-item"},[n("button",{staticClass:"btn",class:{disabled:t.isSubmiting}},[t._v("提交")])])]),t.commentList.length?n("h2",[t._v(t._s(t.title)+" "+t._s(t.subTitle))]):t._e(),n("div",{staticClass:"showComment"},[n("ul",{staticClass:"comment-list"},t._l(t.commentList,(function(e){return n("li",{key:e.id},[n("Avatar",{attrs:{url:e.avatar,size:44}}),n("div",{staticClass:"data"},[n("div",{staticClass:"nickname"},[t._v(t._s(e.nickname))]),n("div",{staticClass:"content"},[t._v(" "+t._s(e.content)+" ")]),n("div",{staticClass:"time"},[t._v(t._s(t._f("formatDate")(e.createDate,!0)))])])],1)})),0)]),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],staticClass:"loading"})])},r=[],o=n("77c0"),i=n("d010"),s={components:{Avatar:o["a"],Icon:i["a"]},props:{title:{type:String,default:""},subTitle:{type:String,default:""},commentList:{type:Array,default:function(){return[]}},isLoading:{type:Boolean,default:!1}},data:function(){return{formData:{nickname:"",content:""},error:{nickname:"",content:""},isSubmiting:!1}},methods:{handkeFocus:function(){this.error.nickname="",this.error.content=""},handleSubmit:function(){var t=this;this.error.nickname=this.formData.nickname?"":"请输入用户昵称",this.error.content=this.formData.content?"":"请留下你宝贵的意见",this.error.nickname||this.error.content||(this.isSubmiting=!0,this.$emit("submit",this.formData,(function(e){t.$showPopInfo({showText:e,showType:"success",container:t.$refs.form,callback:function(){t.isSubmiting=!1,t.formData.nickname="",t.formData.content=""}})})))}}},c=s,l=(n("52f9"),n("2877")),u=Object(l["a"])(c,a,r,!1,null,"034cfd60",null);e["a"]=u.exports},"52f9":function(t,e,n){"use strict";n("4783")},"530f":function(t,e,n){},"857a":function(t,e,n){var a=n("1d80"),r=/"/g;t.exports=function(t,e,n,o){var i=String(a(t)),s="<"+e;return""!==n&&(s+=" "+n+'="'+String(o).replace(r,"&quot;")+'"'),s+">"+i+"</"+e+">"}},a5ff:function(t,e,n){"use strict";n("0d47")},af03:function(t,e,n){var a=n("d039");t.exports=function(t){return a((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}))}},db6a:function(t,e,n){},e3cd:function(t,e,n){}}]);
//# sourceMappingURL=chunk-80bf546e.3edce1ca.js.map